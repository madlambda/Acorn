# Copyright (C) Madlambda Authors

cat << END > common.mk
ACORN_CFLAGS=$CC_OPT
ACORN_LDFLAGS=$LD_OPT
ACORN_INCLUDES=$CC_INCLUDES

LIBDIR=$LIBDIR
INCDIR=$INCDIR

OBJDIR=$OBJDIR
OBJCMDDIR=$OBJCMDDIR
END

cat << END > Makefile
include common.mk

all: acorn oak cmd

.PHONY: acorn
acorn:
	\$(MAKE) -C acorn

.PHONY: oak
oak:
	\$(MAKE) -C oak

.PHONY: cmd
cmd:
	@for c in cmd/*; do \$(MAKE) -C \$\$c; done

.PHONY: linux
linux:
	\$(MAKE) -C linux

.PHONY: linux-test
linux-test:
	\$(MAKE) -C linux tests

.PHONY: clean
clean:
	rm -rf \$(OBJDIR)

END
